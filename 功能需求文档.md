# 公益捐赠管理系统 - 功能需求文档

## 1. 项目概述

### 1.1 项目背景
随着社会公益事业的发展，越来越多的人愿意参与到公益捐赠中来。为了规范公益捐赠流程，提高捐赠透明度，设计并实现一套基于Web的公益捐赠管理系统。该系统采用前后端分离架构，后端使用Spring Boot 3框架，前端使用Vue 3框架，数据库使用MySQL 8.0。

### 1.2 项目目标
- 为普通用户提供便捷的捐赠项目浏览和捐赠功能
- 为管理员提供项目管理和数据统计功能
- 提高公益捐赠的透明度和可信度
- 实现捐赠记录的完整追踪
- 支持图片上传和管理功能，提升用户体验

---

## 2. 用户角色

本系统包含以下两种用户角色：

| 角色 | 权限说明 |
|------|----------|
| 普通用户 | 浏览项目、查看详情、进行捐赠、查看个人捐赠记录、修改个人信息、上传头像、发表评论、查看通知、生成捐赠证书、下载证书 |
| 管理员 | 拥有普通用户所有权限，额外拥有用户管理、项目管理、数据统计、发布感谢留言、上传项目封面图片功能 |

---

## 3. 功能模块

### 3.1 用户管理模块

#### 3.1.1 用户注册
- **功能描述**：新用户可以通过注册页面创建账号
- **输入字段**：
  - 用户名（必填，唯一）
  - 密码（必填）
  - 真实姓名（可选）
  - 手机号（可选）
  - 邮箱（可选）
- **业务规则**：
  - 用户名不能与已存在的用户名重复
  - 密码需进行加密存储
  - 注册成功后自动分配普通用户角色

#### 3.1.2 用户登录
- **功能描述**：已注册用户通过用户名和密码登录系统
- **输入字段**：
  - 用户名
  - 密码
- **登录页面美化**（创新点）：
  - 支持自定义背景图片
  - 页面右下角显示大学名称水印
  - 登录卡片采用半透明毛玻璃效果
  - 整体界面美观大方，符合高校毕设风格
- **业务规则**：
  - 验证用户名和密码的正确性
  - 检查用户状态是否正常（未被禁用）
  - 登录成功后生成JWT Token
  - 记录用户最后登录时间

#### 3.1.3 个人信息管理（创新点）
- **功能描述**：用户可以查看和修改个人信息
- **可修改字段**：
  - 真实姓名
  - 手机号
  - 邮箱
  - 头像（支持上传）
- **累计捐赠展示**（创新点）：
  - 实时从数据库计算并展示用户累计捐赠金额
  - 确保数据准确性，即使历史数据也能正确计算
  - 每次获取用户信息时自动从捐赠记录表统计
- **头像上传功能**：
  - 支持上传jpg、jpeg、png格式图片
  - 图片大小限制在5MB以内
  - 上传后立即更新显示
- **业务规则**：
  - 用户名不可修改
  - 修改信息需要登录验证
  - 头像上传后自动保存到数据库

#### 3.1.4 用户管理（管理员功能）
- **功能描述**：管理员对系统用户进行管理
- **功能列表**：
  - 查看所有用户列表
  - 按角色筛选用户
  - 按状态筛选用户
  - 启用/禁用用户账号
  - 删除用户（逻辑删除）
- **展示信息**：
  - 用户ID、用户名
  - 真实姓名、手机号
  - 角色、状态
  - 头像
  - 注册时间、累计捐赠金额

---

### 3.2 捐赠项目模块

#### 3.2.1 项目列表展示
- **功能描述**：展示所有可捐赠的项目列表
- **展示信息**：
  - 项目封面图片
  - 项目名称
  - 项目简介
  - 项目分类
  - 项目状态（进行中/已完成/已关闭）
  - 目标金额
  - 当前已筹金额
  - 捐赠进度条
  - 捐赠人次
  - 浏览次数
- **筛选功能**：
  - 按项目分类筛选（教育助学/医疗救助/扶贫济困/环保公益）
  - 按项目状态筛选
- **分页功能**：支持分页浏览项目列表

#### 3.2.2 项目详情查看
- **功能描述**：查看单个项目的详细信息
- **展示信息**：
  - 项目基本信息（名称、分类、状态）
  - 项目封面图片
  - 详细描述
  - 受益人信息
  - 项目地点
  - 开始和结束时间
  - 目标金额和已筹金额
  - 捐赠进度
  - 评论列表
  - 感谢留言（创新点）
- **功能入口**：点击项目列表中的项目卡片进入

#### 3.2.3 项目捐赠（创新点）
- **功能描述**：用户对项目进行在线捐赠
- **输入字段**：
  - 捐赠金额
  - 捐赠留言（可选）
  - 是否匿名（可选）
- **支付流程**（创新点）：
  - 点击"立即捐赠"后弹出支付方式选择窗口
  - 支持多种支付方式展示（微信、支付宝、银行卡等）
  - 选择支付方式后显示对应的支付二维码（模拟支付）
  - 3秒后自动显示捐赠成功弹窗
  - 成功弹窗中显示项目名称等捐赠信息
  - 点击"查看详情"可跳转到个人捐赠记录页面
- **业务规则**：
  - 捐赠金额必须大于0
  - 捐赠成功后生成唯一捐赠编号
  - 更新项目当前已筹金额
  - 更新项目捐赠人次
  - 实时更新用户累计捐赠金额（从捐赠记录表计算）
  - 记录捐赠时间
- **创新点说明**：
  - 支持匿名捐赠，保护用户隐私
  - 完整的支付流程模拟，提升用户体验
  - 捐赠成功后动态展示项目名称
  - 实时从数据库计算累计捐赠金额，确保数据准确性
  - 生成唯一捐赠编号，便于后续查询和追踪

#### 3.2.4 项目封面图片管理（创新点）
- **功能描述**：管理员可以为每个项目上传和更换封面图片
- **功能说明**：
  - 在项目管理页面，每个项目都有更改封面图片的功能
  - 支持上传jpg、jpeg、png格式图片
  - 图片大小限制在5MB以内
  - 上传后立即更新项目封面
- **创新点说明**：
  - 提升项目展示效果
  - 增强视觉吸引力
  - 灵活管理项目展示内容

#### 3.2.5 感谢留言管理（创新点）
- **功能描述**：管理员可以为项目发布感谢留言
- **功能说明**：
  - 感谢留言展示在项目详情页
  - 用于向所有捐赠人表达感谢
  - 可随时修改感谢留言内容
- **创新点说明**：
  - 增强捐赠反馈体验
  - 提升捐赠人荣誉感和参与感
  - 促进公益文化传播

---

### 3.3 捐赠记录模块

#### 3.3.1 我的捐赠记录
- **功能描述**：用户查看自己的所有捐赠记录
- **展示信息**：
  - 捐赠项目名称
  - 捐赠金额
  - 捐赠时间
  - 捐赠编号
  - 捐赠留言
  - 是否匿名
- **业务规则**：
  - 只显示当前登录用户的捐赠记录
  - 按捐赠时间倒序排列

#### 3.3.2 捐赠证书生成与下载（创新点）
- **功能描述**：用户可以为自己的每笔捐赠生成电子捐赠证书并下载
- **证书内容**：
  - 捐赠编号
  - 捐赠人姓名（匿名显示为"爱心人士"）
  - 捐赠项目名称
  - 捐赠金额
  - 捐赠时间
  - 捐赠留言
  - 证书二维码（可扫描验证）
- **下载功能**：
  - 支持将证书下载为图片格式（PNG）
  - 使用html2canvas技术实现图片下载
- **创新点说明**：
  - 提供正式的捐赠凭证
  - 增强捐赠仪式感
  - 可保存和分享，增加公益宣传效果
  - 二维码验证功能提升证书可信度

---

### 3.4 评论互动模块

#### 3.4.1 发表评论
- **功能描述**：用户可以对项目发表评论
- **输入字段**：
  - 评论内容
- **业务规则**：
  - 需要登录才能发表评论
  - 评论自动关联当前用户和项目

#### 3.4.2 评论列表
- **功能描述**：查看项目的所有评论
- **展示信息**：
  - 评论内容
  - 评论人头像
  - 评论人
  - 评论时间
  - 点赞数
- **业务规则**：
  - 按时间倒序排列
  - 支持点赞功能

#### 3.4.3 评论点赞
- **功能描述**：用户可以对评论进行点赞
- **业务规则**：
  - 每次点赞增加一个点赞数
  - 可重复点赞（简单实现）

#### 3.4.4 删除评论
- **功能描述**：用户可以删除自己的评论，管理员可以删除任意评论
- **业务规则**：
  - 逻辑删除，不物理删除

---

### 3.5 通知管理模块

#### 3.5.1 通知列表
- **功能描述**：用户查看自己的所有通知
- **通知类型**：
  - 系统通知
  - 捐赠通知
  - 活动通知
- **展示信息**：
  - 通知标题
  - 通知内容
  - 通知时间
  - 是否已读状态

#### 3.5.2 未读通知计数
- **功能描述**：显示用户未读通知的数量
- **业务规则**：
  - 实时统计未读通知数
  - 用于提醒用户查看

#### 3.5.3 标记已读
- **功能描述**：用户可以将通知标记为已读
- **功能列表**：
  - 单条通知标记已读
  - 全部通知标记已读

---

### 3.6 管理员功能模块

#### 3.6.1 项目管理
- **功能描述**：管理员对捐赠项目进行管理
- **功能列表**：
  - 新增项目
  - 编辑项目信息
  - 查看项目详情
  - 修改项目状态
  - 上传/更换项目封面图片
  - 发布感谢留言
- **项目信息字段**：
  - 项目名称
  - 项目分类
  - 项目描述
  - 封面图片
  - 目标金额
  - 受益人
  - 项目地点
  - 开始和结束时间
  - 项目状态

#### 3.6.2 数据统计（创新点）
- **功能描述**：展示系统的各项统计数据
- **统计内容**：
  - 总体统计：
    - 总捐赠金额
    - 总捐赠次数
    - 项目总数
    - 用户总数
  - 每日趋势统计（创新点）：
    - 每日捐赠金额折线图
    - 按日期展示捐赠变化趋势
    - 支持查看近30天数据
  - 分类统计：
    - 各分类项目捐赠情况饼图
- **创新点说明**：
  - 数据可视化展示（图表形式）
  - 实时统计更新
  - 多维度数据分析（按日期、按分类等）
  - 为管理决策提供数据支持
  - 每日趋势图直观展示捐赠变化

---

## 4. 数据库设计

### 4.1 用户表（user）

| 字段名 | 类型 | 说明 | 约束 |
|--------|------|------|------|
| id | BIGINT | 用户ID | 主键，自增 |
| username | VARCHAR(50) | 用户名 | 非空，唯一 |
| password | VARCHAR(255) | 密码 | 非空 |
| real_name | VARCHAR(50) | 真实姓名 | |
| phone | VARCHAR(20) | 手机号 | |
| email | VARCHAR(100) | 邮箱 | |
| avatar | VARCHAR(255) | 头像 | |
| role | TINYINT | 角色 | 0-普通用户，1-管理员 |
| status | TINYINT | 状态 | 0-禁用，1-正常 |
| total_donation | DECIMAL(15,2) | 累计捐赠金额 | |
| registration_date | DATETIME | 注册时间 | |
| last_login_date | DATETIME | 最后登录时间 | |
| create_time | DATETIME | 创建时间 | |
| update_time | DATETIME | 更新时间 | |
| deleted | TINYINT | 逻辑删除 | 0-未删除，1-已删除 |

### 4.2 捐赠项目表（donation_project）

| 字段名 | 类型 | 说明 | 约束 |
|--------|------|------|------|
| id | BIGINT | 项目ID | 主键，自增 |
| project_name | VARCHAR(200) | 项目名称 | 非空 |
| category | VARCHAR(50) | 项目分类 | |
| description | TEXT | 项目描述 | |
| cover_image | VARCHAR(255) | 封面图片 | |
| target_amount | DECIMAL(15,2) | 目标金额 | 非空 |
| current_amount | DECIMAL(15,2) | 当前已筹金额 | |
| donor_count | INT | 捐赠人次 | |
| view_count | INT | 浏览次数 | |
| beneficiary | VARCHAR(200) | 受益人 | |
| location | VARCHAR(200) | 项目地点 | |
| start_date | DATE | 开始时间 | |
| end_date | DATE | 结束时间 | |
| status | TINYINT | 状态 | 0-待审核，1-进行中，2-已完成，3-已关闭 |
| create_by | BIGINT | 创建人ID | |
| create_time | DATETIME | 创建时间 | |
| update_time | DATETIME | 更新时间 | |
| deleted | TINYINT | 逻辑删除 | 0-未删除，1-已删除 |
| thank_message | TEXT | 感谢留言 | |

### 4.3 捐赠记录表（donation_record）

| 字段名 | 类型 | 说明 | 约束 |
|--------|------|------|------|
| id | BIGINT | 记录ID | 主键，自增 |
| user_id | BIGINT | 捐赠用户ID | |
| project_id | BIGINT | 项目ID | 非空 |
| amount | DECIMAL(15,2) | 捐赠金额 | 非空 |
| payment_method | VARCHAR(50) | 支付方式 | |
| transaction_id | VARCHAR(100) | 交易流水号 | |
| donation_no | VARCHAR(50) | 捐赠编号 | 非空，唯一 |
| message | TEXT | 捐赠留言 | |
| is_anonymous | TINYINT | 是否匿名 | 0-否，1-是 |
| status | TINYINT | 状态 | 0-待支付，1-已完成，2-已取消，3-已退款 |
| donation_date | DATETIME | 捐赠时间 | |
| create_time | DATETIME | 创建时间 | |
| update_time | DATETIME | 更新时间 | |
| deleted | TINYINT | 逻辑删除 | 0-未删除，1-已删除 |

### 4.4 评论表（comment）

| 字段名 | 类型 | 说明 | 约束 |
|--------|------|------|------|
| id | BIGINT | 评论ID | 主键，自增 |
| project_id | BIGINT | 项目ID | 非空 |
| user_id | BIGINT | 用户ID | |
| content | TEXT | 评论内容 | 非空 |
| likes_count | INT | 点赞数 | |
| status | TINYINT | 状态 | 0-待审核，1-已发布，2-已删除 |
| comment_date | DATETIME | 评论时间 | |
| create_time | DATETIME | 创建时间 | |
| update_time | DATETIME | 更新时间 | |
| deleted | TINYINT | 逻辑删除 | 0-未删除，1-已删除 |

### 4.5 通知表（notification）

| 字段名 | 类型 | 说明 | 约束 |
|--------|------|------|------|
| id | BIGINT | 通知ID | 主键，自增 |
| user_id | BIGINT | 接收用户ID | |
| title | VARCHAR(200) | 通知标题 | 非空 |
| content | TEXT | 通知内容 | |
| type | TINYINT | 类型 | 1-系统通知，2-捐赠通知，3-活动通知 |
| is_read | TINYINT | 是否已读 | 0-未读，1-已读 |
| send_date | DATETIME | 发送时间 | |
| create_time | DATETIME | 创建时间 | |
| update_time | DATETIME | 更新时间 | |
| deleted | TINYINT | 逻辑删除 | 0-未删除，1-已删除 |

### 4.6 数据统计表（statistics）

| 字段名 | 类型 | 说明 | 约束 |
|--------|------|------|------|
| id | BIGINT | 统计ID | 主键，自增 |
| stat_date | DATE | 统计日期 | 非空，唯一 |
| total_donation_amount | DECIMAL(15,2) | 当日捐赠总额 | |
| total_donation_count | INT | 当日捐赠次数 | |
| total_project_count | INT | 项目总数 | |
| total_user_count | INT | 用户总数 | |
| create_time | DATETIME | 创建时间 | |
| update_time | DATETIME | 更新时间 | |

---

## 5. 技术架构

### 5.1 后端技术栈
- **框架**：Spring Boot 3.2.5
- **ORM**：Spring Data JPA
- **数据库**：MySQL 8.0
- **认证**：JWT（JSON Web Token）
- **构建工具**：Maven
- **JDK版本**：Java 21
- **文件上传**：MultipartFile，支持头像和项目封面图片上传

### 5.2 前端技术栈
- **框架**：Vue 3（组合式API + Setup语法糖）
- **UI组件库**：Element Plus 2.4.4
- **路由**：Vue Router
- **状态管理**：Pinia
- **HTTP客户端**：Axios 1.6.x
- **构建工具**：Vite
- **Node版本**：18.18.0
- **图表库**：ECharts（数据统计可视化）
- **二维码**：QRCode.js（证书二维码生成）
- **图片下载**：html2canvas（证书下载）

### 5.3 系统架构
- **架构模式**：前后端分离
- **接口风格**：RESTful API
- **数据格式**：JSON

---

## 6. 创新点说明

本项目包含以下八个创新点，符合毕设要求：

### 6.1 匿名捐赠功能
- **功能描述**：用户在捐赠时可以选择是否匿名
- **创新价值**：
  - 保护用户隐私，满足不同用户的捐赠需求
  - 提高用户参与捐赠的积极性
  - 符合现代公益捐赠的发展趋势

### 6.2 数据统计与可视化
- **功能描述**：管理员可以查看系统的各项统计数据，并以图表形式展示
- **创新价值**：
  - 实时展示系统运营数据
  - 多维度数据分析（按日期、按分类等）
  - 为管理决策提供数据支持
  - 提升系统的专业性和实用性
  - 每日趋势图直观展示捐赠变化

### 6.3 捐赠证书生成与下载
- **功能描述**：用户可以为每笔捐赠生成电子捐赠证书并下载
- **创新价值**：
  - 提供正式的捐赠凭证，增加仪式感
  - 可保存和分享，扩大公益影响力
  - 提升用户捐赠荣誉感
  - 二维码验证功能提升证书可信度

### 6.4 感谢留言功能
- **功能描述**：管理员可以为项目发布感谢留言，向所有捐赠人表达感谢
- **创新价值**：
  - 增强捐赠反馈体验
  - 提升捐赠人参与感和荣誉感
  - 促进公益文化传播和社会正能量

### 6.5 头像上传与管理
- **功能描述**：用户可以上传和更换个人头像，提升用户体验
- **创新价值**：
  - 增强用户个性化体验
  - 提升系统美观度
  - 符合现代Web应用标准

### 6.6 项目封面图片管理
- **功能描述**：管理员可以为每个项目上传和更换封面图片
- **创新价值**：
  - 提升项目展示效果
  - 增强视觉吸引力
  - 灵活管理项目展示内容

### 6.7 完整支付流程模拟（新增）
- **功能描述**：点击"立即捐赠"后展示支付方式选择、支付二维码、捐赠成功弹窗的完整流程
- **创新价值**：
  - 提升用户捐赠体验，模拟真实支付场景
  - 捐赠成功后动态展示项目名称，增强仪式感
  - 点击"查看详情"可直接跳转到捐赠记录页面
  - 无需真实支付接口，降低开发复杂度，适合毕设场景

### 6.8 累计捐赠金额实时计算（新增）
- **功能描述**：从捐赠记录表中实时计算用户的累计捐赠金额，确保数据准确性
- **创新价值**：
  - 解决历史数据累计捐赠不准确的问题
  - 每次获取用户信息时自动从数据库统计
  - 数据实时同步，可靠性高
  - 为用户提供准确的捐赠数据展示

### 6.9 登录页面美化（新增）
- **功能描述**：登录页面支持自定义背景图片、大学名称水印、半透明毛玻璃效果
- **创新价值**：
  - 提升系统视觉美观度
  - 符合高校毕设的设计风格
  - 增强用户第一印象
  - 水印展示大学名称，突出毕设特色

---

## 7. 非功能需求

### 7.1 性能需求
- 系统响应时间：页面加载时间不超过3秒
- 并发支持：支持至少100个用户同时在线
- 数据处理：捐赠记录查询响应时间不超过1秒
- 文件上传：图片上传响应时间不超过5秒

### 7.2 安全需求
- 用户密码加密存储
- 登录采用JWT Token认证
- 敏感操作需要身份验证
- 防止SQL注入、XSS攻击
- 文件上传限制格式和大小
- 静态资源访问安全配置

### 7.3 可用性需求
- 界面简洁美观，操作流程清晰
- 提供友好的错误提示
- 支持主流浏览器（Chrome、Firefox、Edge）
- 图片加载失败时显示默认占位图

### 7.4 可维护性需求
- 代码结构清晰，注释完整
- 遵循编码规范
- 前后端接口文档完整
- 使用DTO模式处理数据传输

---

## 8. 功能模块统计

### 8.1 功能清单
| 模块 | 子模块 | 功能数量 |
|------|--------|----------|
| 用户管理 | 注册、登录（含美化）、个人信息（含头像上传、累计捐赠实时计算）、用户管理 | 4 |
| 捐赠项目 | 列表、详情、捐赠（含完整支付流程）、封面图片管理、感谢留言 | 5 |
| 捐赠记录 | 我的记录、捐赠证书（含下载） | 2 |
| 评论互动 | 发表、列表、点赞、删除 | 4 |
| 通知管理 | 列表、未读计数、标记已读 | 3 |
| 管理员功能 | 项目管理、数据统计 | 2 |
| **总计** | | **20个核心功能** |

---

## 9. 测试账号

系统预设以下测试账号：

| 账号 | 密码 | 角色 |
|------|------|------|
| admin | 123456 | 管理员 |
| user1 | 123456 | 普通用户 |
| user2 | 123456 | 普通用户 |

---

## 10. 项目进度安排

| 阶段 | 工作内容 | 预计时间 |
|------|----------|----------|
| 第一阶段 | 需求分析与数据库设计 | 1周 |
| 第二阶段 | 后端接口开发 | 3周 |
| 第三阶段 | 前端页面开发 | 3周 |
| 第四阶段 | 系统联调与测试 | 1周 |
| 第五阶段 | 论文撰写与答辩准备 | 1周 |
| **总计** | | **9周** |

---

## 11. 总结

本公益捐赠管理系统实现了**6大功能模块、20个核心功能**，包括：
- 用户管理模块（注册、登录、个人信息、用户管理）
- 捐赠项目模块（列表、详情、捐赠、封面图片管理、感谢留言）
- 捐赠记录模块（我的记录、捐赠证书）
- 评论互动模块（发表、列表、点赞、删除）
- 通知管理模块（列表、未读计数、标记已读）
- 管理员功能模块（项目管理、数据统计）

系统采用Spring Boot 3 + Vue 3的技术栈，符合本科毕设的功能复杂度要求。系统包含**9个创新点**：
1. 匿名捐赠功能
2. 数据统计与可视化（含每日趋势图）
3. 捐赠证书生成与下载
4. 感谢留言功能
5. 头像上传与管理
6. 项目封面图片管理
7. 完整支付流程模拟（新增）
8. 累计捐赠金额实时计算（新增）
9. 登录页面美化（新增）

系统功能完整、界面美观、技术先进，具有较高的实用价值和应用前景，完全能够满足毕设答辩要求。
