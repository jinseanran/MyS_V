# 公益捐赠管理系统 - 功能需求文档【详细版】

## 1. 项目概述

### 1.1 项目背景
随着社会公益事业的发展，越来越多的人愿意参与到公益捐赠中来。为了规范公益捐赠流程，提高捐赠透明度，设计并实现一套基于Web的公益捐赠管理系统。该系统采用前后端分离架构，后端使用Spring Boot 3框架，前端使用Vue 3框架，数据库使用MySQL 8.0。

### 1.2 项目目标
- 为普通用户提供便捷的捐赠项目浏览和捐赠功能
- 为管理员提供项目管理和数据统计功能
- 提高公益捐赠的透明度和可信度
- 实现捐赠记录的完整追踪
- 支持图片上传和管理功能，提升用户体验
- 提供美观的界面设计和良好的用户体验
- 实现AI智能推荐功能，根据用户偏好推荐捐赠项目
- 提供捐赠证书生成与下载功能

---

## 2. 用户角色

本系统包含以下两种用户角色：

| 角色 | 权限说明 |
|------|----------|
| 普通用户 | 浏览项目、查看详情、进行捐赠、查看个人捐赠记录、修改个人信息、上传头像、修改密码、发表评论、查看通知、生成捐赠证书、下载证书、AI智能推荐、查看用户偏好分析 |
| 管理员 | 拥有普通用户所有权限，额外拥有用户管理、项目管理、数据统计、发布感谢留言、上传项目封面图片、系统设置（安全提醒）功能 |

---

## 3. 功能模块

### 3.1 用户管理模块

#### 3.1.1 用户注册
- **功能描述**：新用户可以通过注册页面创建账号
- **输入字段**：
  - 用户名（必填，唯一）
  - 密码（必填）
  - 真实姓名（可选）
  - 手机号（可选）
  - 邮箱（可选）
- **业务规则**：
  - 用户名不能与已存在的用户名重复
  - 密码需进行BCrypt加密存储
  - 注册成功后自动分配普通用户角色（role=0）
  - 自动记录注册时间
  - 用户状态默认为正常（status=1）

#### 3.1.2 用户登录
- **功能描述**：已注册用户通过用户名和密码登录系统
- **输入字段**：
  - 用户名
  - 密码
- **登录页面美化**（创新点）：
  - 支持自定义背景图片
  - 页面右下角显示大学名称水印
  - 登录卡片采用半透明毛玻璃效果
  - 整体界面美观大方，符合高校毕设风格
- **业务规则**：
  - 验证用户名和密码的正确性
  - 检查用户状态是否正常（未被禁用）
  - 登录成功后生成JWT Token
  - 记录用户最后登录时间
  - Token有效期设置为合理时间

#### 3.1.3 个人信息管理（创新点）
- **功能描述**：用户可以查看和修改个人信息
- **可修改字段**：
  - 真实姓名
  - 手机号
  - 邮箱
  - 头像（支持上传）
- **累计捐赠展示**（创新点）：
  - 实时从数据库计算并展示用户累计捐赠金额
  - 确保数据准确性，即使历史数据也能正确计算
  - 每次获取用户信息时自动从捐赠记录表统计
  - 计算公式：SUM(donation_record.amount) WHERE user_id = 当前用户ID AND status = 1
- **头像上传功能**：
  - 支持上传jpg、jpeg、png格式图片
  - 图片大小限制在5MB以内
  - 上传后立即更新显示
  - 图片存储在服务器指定目录
- **业务规则**：
  - 用户名不可修改
  - 修改信息需要登录验证
  - 头像上传后自动保存到数据库
  - 修改信息时自动更新update_time字段

#### 3.1.4 修改密码（新增）
- **功能描述**：用户可以修改登录密码
- **输入字段**：
  - 原密码
  - 新密码
  - 确认密码
- **业务规则**：
  - 验证原密码是否正确（BCrypt校验）
  - 新密码与确认密码必须一致
  - 密码修改成功后需要重新登录
  - 新密码需进行BCrypt加密存储
- **安全提示**：
  - 建议定期更换密码
  - 使用强密码（包含大小写字母、数字和特殊字符）

#### 3.1.5 用户管理（管理员功能）
- **功能描述**：管理员对系统用户进行管理
- **功能列表**：
  - 查看所有用户列表（分页）
  - 按角色筛选用户（普通用户/管理员）
  - 按状态筛选用户（正常/禁用）
  - 按用户名搜索用户
  - 启用/禁用用户账号
  - 删除用户（逻辑删除，设置deleted=1）
- **展示信息**：
  - 用户ID、用户名
  - 真实姓名、手机号
  - 角色、状态
  - 头像
  - 注册时间
  - 累计捐赠金额（实时计算）
  - 最后登录时间

---

### 3.2 捐赠项目模块

#### 3.2.1 项目列表展示（新增UI美化）
- **功能描述**：展示所有可捐赠的项目列表
- **UI美化**（创新点）：
  - 所有项目卡片高度一致，采用Flex布局
  - 精美渐变色进度条（根据完成度显示不同颜色）
    - 完成度&lt;50%：蓝色渐变
    - 完成度≥50%且&lt;100%：绿色渐变
    - 完成度≥100%：深绿色
  - 卡片悬停动画效果（上移+阴影加深）
  - 图片缩放动画（悬停时放大1.05倍）
  - 圆角设计和柔和阴影
- **展示信息**：
  - 项目封面图片
  - 项目名称
  - 项目简介（截取前100字符）
  - 项目分类标签
  - 项目状态标签（进行中/已完成/已关闭）
  - 目标金额（格式化显示）
  - 当前已筹金额（格式化显示）
  - 捐赠进度条（渐变色）
  - 捐赠人次
  - 浏览次数
- **筛选功能**：
  - 按项目分类筛选（教育助学/医疗救助/扶贫济困/环保公益）
  - 按项目状态筛选（进行中/已完成）
  - 支持关键词搜索项目名称
- **分页功能**：支持分页浏览项目列表，每页显示8个项目

#### 3.2.2 项目详情查看
- **功能描述**：查看单个项目的详细信息
- **展示信息**：
  - 项目基本信息（名称、分类、状态）
  - 项目封面图片（大图展示）
  - 详细描述（完整内容）
  - 受益人信息
  - 项目地点
  - 开始和结束时间
  - 目标金额和已筹金额
  - 捐赠进度（圆形进度条展示）
  - 感谢留言（创新点）
  - 评论列表
- **功能入口**：点击项目列表中的项目卡片进入
- **业务规则**：
  - 访问项目详情时自动增加浏览次数（view_count + 1）
  - 如果用户已登录，记录用户对该项目类别的浏览偏好

#### 3.2.3 项目捐赠（创新点）
- **功能描述**：用户对项目进行在线捐赠
- **输入字段**：
  - 捐赠金额（支持预设金额：50/100/200/500元，或自定义金额）
  - 捐赠留言（可选，最多200字）
  - 是否匿名（可选，默认不匿名）
- **支付流程**（创新点）：
  - 点击"立即捐赠"后弹出支付方式选择窗口
  - 支持多种支付方式展示（微信支付、支付宝、银行卡）
  - 选择支付方式后显示对应的支付二维码（模拟支付）
  - 3秒倒计时后自动显示捐赠成功弹窗
  - 成功弹窗中显示：
    - 项目名称
    - 捐赠金额
    - 捐赠编号
  - 点击"查看详情"可跳转到个人捐赠记录页面
- **业务规则**：
  - 捐赠金额必须大于0
  - 捐赠成功后生成唯一捐赠编号（格式：DON + yyyyMMdd + 6位序号）
  - 更新项目当前已筹金额（current_amount + 捐赠金额）
  - 更新项目捐赠人次（donor_count + 1）
  - 记录捐赠时间（donation_date）
  - 如果用户已登录，记录用户对该项目类别的捐赠偏好
- **创新点说明**：
  - 支持匿名捐赠，保护用户隐私
  - 完整的支付流程模拟，提升用户体验
  - 捐赠成功后动态展示项目名称
  - 生成唯一捐赠编号，便于后续查询和追踪

#### 3.2.4 项目封面图片管理（创新点）
- **功能描述**：管理员可以为每个项目上传和更换封面图片
- **功能说明**：
  - 在项目管理页面，每个项目都有更改封面图片的功能
  - 支持上传jpg、jpeg、png格式图片
  - 图片大小限制在5MB以内
  - 上传后立即更新项目封面
  - 支持预览上传的图片
- **创新点说明**：
  - 提升项目展示效果
  - 增强视觉吸引力
  - 灵活管理项目展示内容

#### 3.2.5 感谢留言管理（创新点）
- **功能描述**：管理员可以为项目发布感谢留言
- **功能说明**：
  - 感谢留言展示在项目详情页
  - 用于向所有捐赠人表达感谢
  - 可随时修改感谢留言内容
  - 支持富文本格式（可选）
- **创新点说明**：
  - 增强捐赠反馈体验
  - 提升捐赠人荣誉感和参与感
  - 促进公益文化传播

---

### 3.3 捐赠记录模块

#### 3.3.1 我的捐赠记录
- **功能描述**：用户查看自己的所有捐赠记录
- **展示信息**：
  - 捐赠项目封面图片
  - 捐赠项目名称
  - 捐赠金额（格式化显示）
  - 捐赠时间
  - 捐赠编号
  - 捐赠留言
  - 是否匿名（显示标签）
  - 操作按钮（查看证书）
- **业务规则**：
  - 只显示当前登录用户的捐赠记录
  - 按捐赠时间倒序排列
  - 支持分页查看
  - 只显示已完成的捐赠记录（status=1）

#### 3.3.2 捐赠证书生成与下载（创新点）
- **功能描述**：用户可以为自己的每笔捐赠生成电子捐赠证书并下载
- **证书内容**：
  - 捐赠编号
  - 捐赠人姓名（匿名显示为"爱心人士"）
  - 捐赠项目名称
  - 捐赠金额（大写显示）
  - 捐赠时间
  - 捐赠留言
  - 证书二维码（可扫描验证，包含捐赠编号）
  - 公益基金会印章（图片）
  - 证书编号
- **证书设计**（创新点）：
  - 精美渐变背景（金色+白色）
  - 边框装饰（红色边框）
  - 正式的证书排版
  - 基金会Logo和名称
- **下载功能**：
  - 支持将证书下载为图片格式（PNG）
  - 使用html2canvas技术实现图片下载
  - 图片清晰度：2倍缩放
  - 文件名格式：捐赠证书-{捐赠编号}.png
- **创新点说明**：
  - 提供正式的捐赠凭证，增加仪式感
  - 可保存和分享，扩大公益影响力
  - 提升用户捐赠荣誉感
  - 二维码验证功能提升证书可信度

---

### 3.4 评论互动模块

#### 3.4.1 发表评论
- **功能描述**：用户可以对项目发表评论
- **输入字段**：
  - 评论内容（必填，最多500字）
- **业务规则**：
  - 需要登录才能发表评论
  - 评论自动关联当前用户和项目
  - 自动记录评论时间
  - 点赞数初始为0
  - 评论状态默认为已发布（status=1）

#### 3.4.2 评论列表
- **功能描述**：查看项目的所有评论
- **展示信息**：
  - 评论人头像
  - 评论人姓名（匿名显示为"爱心用户"）
  - 评论内容
  - 评论时间（相对时间显示：刚刚/5分钟前/1小时前等）
  - 点赞数
  - 操作按钮（点赞、删除-仅自己或管理员可见）
- **业务规则**：
  - 按时间倒序排列
  - 支持分页查看（每页5条）
  - 只显示已发布的评论（status=1）

#### 3.4.3 评论点赞
- **功能描述**：用户可以对评论进行点赞
- **业务规则**：
  - 每次点赞增加一个点赞数
  - 可重复点赞（简单实现）
  - 点赞后立即更新显示

#### 3.4.4 删除评论
- **功能描述**：用户可以删除自己的评论，管理员可以删除任意评论
- **业务规则**：
  - 逻辑删除，设置status=2（已删除）
  - 删除前需要确认
  - 普通用户只能删除自己的评论
  - 管理员可以删除任意评论

---

### 3.5 通知管理模块

#### 3.5.1 通知列表
- **功能描述**：用户查看自己的所有通知
- **通知类型**：
  - 系统通知（type=1）
  - 捐赠通知（type=2）
  - 活动通知（type=3）
- **展示信息**：
  - 通知标题
  - 通知内容（截取前50字符）
  - 通知时间
  - 是否已读状态（未读显示红点）
  - 通知类型图标
- **业务规则**：
  - 按时间倒序排列
  - 支持分页查看
  - 系统通知（user_id为空）所有用户可见
  - 个人通知只对相应用户可见

#### 3.5.2 未读通知计数
- **功能描述**：显示用户未读通知的数量
- **业务规则**：
  - 实时统计未读通知数
  - 用于提醒用户查看
  - 显示在导航栏通知图标上

#### 3.5.3 标记已读
- **功能描述**：用户可以将通知标记为已读
- **功能列表**：
  - 单条通知标记已读
  - 全部通知标记已读
- **业务规则**：
  - 标记已读后更新is_read字段为1
  - 标记已读后未读计数相应减少

---

### 3.6 管理员功能模块

#### 3.6.1 项目管理
- **功能描述**：管理员对捐赠项目进行管理
- **功能列表**：
  - 新增项目
  - 编辑项目信息
  - 查看项目详情
  - 修改项目状态（待审核→进行中→已完成→已关闭）
  - 上传/更换项目封面图片
  - 发布/修改感谢留言
  - 删除项目（逻辑删除）
- **项目信息字段**：
  - 项目名称（必填）
  - 项目分类（必填：教育助学/医疗救助/扶贫济困/环保公益）
  - 项目描述（必填）
  - 封面图片（可选）
  - 目标金额（必填，大于0）
  - 受益人（可选）
  - 项目地点（可选）
  - 开始时间（可选）
  - 结束时间（可选）
  - 项目状态（必填）

#### 3.6.2 数据统计（创新点）
- **功能描述**：展示系统的各项统计数据
- **统计内容**：
  - 总体统计（卡片展示）：
    - 总捐赠金额（格式化显示，带单位）
    - 总捐赠次数
    - 项目总数
    - 用户总数
  - 每日趋势统计（创新点）：
    - 每日捐赠金额折线图（ECharts展示）
    - 按日期展示捐赠变化趋势
    - 支持查看近7天/近30天数据
    - X轴：日期，Y轴：捐赠金额
  - 分类统计：
    - 各分类项目捐赠情况饼图（ECharts展示）
    - 展示每个分类的捐赠金额占比
    - 支持点击查看详情
- **创新点说明**：
  - 数据可视化展示（图表形式）
  - 实时统计更新
  - 多维度数据分析（按日期、按分类等）
  - 为管理决策提供数据支持
  - 每日趋势图直观展示捐赠变化

#### 3.6.3 系统设置（新增安全提醒）
- **功能描述**：管理员查看系统信息和安全提醒
- **安全提醒内容**（创新点）：
  - 提醒管理员定期更换密码
  - 建议使用强密码（包含大小写字母、数字和特殊字符）
  - 提醒不要在公共设备上登录管理员账户
  - 提醒操作完成后及时退出登录
  - 提醒保管好账户信息，不要泄露给他人
- **系统信息展示**：
  - 系统名称
  - 版本号
  - 后端地址
  - 数据库连接状态
  - 服务器运行时间
- **创新点说明**：
  - 增强系统安全性
  - 提高管理员安全意识
  - 符合信息安全最佳实践
  - 体现系统的专业性和完整性

---

### 3.7 首页美化（新增）

#### 3.7.1 首页UI设计（创新点）
- **功能描述**：精美的首页设计，提升用户第一印象
- **UI特色**：
  - 顶部导航栏：
    - 毛玻璃效果背景
    - 渐变Logo图标
    - 悬停下划线动画
    - 响应式布局
  - Hero区域：
    - 渐变背景（蓝色到青色）
    - 浮动图标动画
    - 按钮悬停效果（缩放+阴影）
    - 醒目的宣传文案
  - 公益分类卡片：
    - 悬停上移效果
    - 渐变色边框
    - 图片缩放动画
    - 中心图标
    - 分类名称和简介
  - 数据统计区域：
    - 渐变背景
    - 毛玻璃卡片效果
    - 实时统计数据展示
    - 图标+数字组合
  - 精美页脚：
    - 深色渐变背景
    - 联系方式
    - 版权信息
    - 友情链接
- **响应式设计**：
  - 适配桌面端（1920px+）
  - 适配平板（768px-1024px）
  - 适配手机（&lt;768px）
- **创新点说明**：
  - 现代化UI设计，符合当前Web应用审美
  - 丰富的交互动画，提升用户体验
  - 渐变色彩搭配，视觉效果出色
  - 完全响应式，适配各种设备

---

### 3.8 AI智能推荐（新增创新点）

#### 3.8.1 个性化项目推荐（核心创新点）
- **功能描述**：根据用户的浏览和捐赠行为，智能推荐符合用户偏好的捐赠项目
- **推荐算法**：
  - 用户偏好分析：
    - 基于用户浏览和捐赠历史，统计各类别偏好得分
    - 浏览一次：+1分
    - 捐赠一次：+5分
    - 偏好得分 = 浏览次数×1 + 捐赠次数×5
  - 项目评分机制（综合评分）：
    - 偏好匹配度：用户偏好类别权重×1.5（最高5分）
    - 捐赠进度：完成度×2.0（最高2分，100%时）
    - 浏览热度：浏览次数×0.01（最高3分）
    - 捐赠热度：捐赠人次×0.05（最高2分）
    - 紧急程度：剩余7天内+3分，30天内+2分，90天内+1分
  - 冷启动处理：
    - 新用户或无偏好记录时，推荐热门项目
    - 热门项目排序：浏览次数×0.3 + 捐赠人次×0.7
  - 推荐数量：每次推荐6个项目
- **功能特性**：
  - 实时记录用户浏览行为（访问项目详情时）
  - 实时记录用户捐赠行为（捐赠成功后）
  - 动态更新用户偏好（每次行为后更新）
  - 支持手动刷新推荐（点击"刷新推荐"按钮）
  - 展示推荐理由（如"基于您的浏览偏好"、"热门推荐"等）
- **创新点说明**：
  - 提升用户捐赠体验，快速找到感兴趣的项目
  - 促进用户参与捐赠，提高捐赠转化率
  - 体现AI技术在公益领域的应用
  - 具有较高的技术含量和实用价值
  - 冷启动处理机制，新用户也能获得推荐

#### 3.8.2 用户偏好分析展示
- **功能描述**：可视化展示用户的捐赠偏好
- **展示内容**：
  - 各类别浏览次数（柱状图展示）
  - 各类别捐赠次数（柱状图展示）
  - 各类别偏好得分（饼图展示）
  - 偏好类别排名（Top 3）
- **创新点说明**：
  - 让用户了解自己的捐赠偏好
  - 增加系统的趣味性和互动性
  - 提升用户参与感
  - 数据可视化展示，直观易懂

---

## 4. 数据库设计

### 4.1 用户表（user）

| 字段名 | 类型 | 说明 | 约束 |
|--------|------|------|------|
| id | BIGINT | 用户ID | 主键，自增 |
| username | VARCHAR(50) | 用户名 | 非空，唯一 |
| password | VARCHAR(255) | 密码（BCrypt加密） | 非空 |
| real_name | VARCHAR(50) | 真实姓名 | |
| phone | VARCHAR(20) | 手机号 | |
| email | VARCHAR(100) | 邮箱 | |
| avatar | VARCHAR(255) | 头像URL | 默认'/default-avatar.jpg' |
| role | TINYINT | 角色 | 0-普通用户，1-管理员，默认0 |
| status | TINYINT | 状态 | 0-禁用，1-正常，默认1 |
| total_donation | DECIMAL(15,2) | 累计捐赠金额 | 默认0.00 |
| registration_date | DATETIME | 注册时间 | |
| last_login_date | DATETIME | 最后登录时间 | |
| create_time | DATETIME | 创建时间 | 默认CURRENT_TIMESTAMP |
| update_time | DATETIME | 更新时间 | 默认CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP |
| deleted | TINYINT | 逻辑删除 | 0-未删除，1-已删除，默认0 |

**索引**：
- idx_username：用户名索引（加速登录查询）
- idx_role：角色索引（加速按角色筛选）
- idx_status：状态索引（加速按状态筛选）

### 4.2 捐赠项目表（donation_project）

| 字段名 | 类型 | 说明 | 约束 |
|--------|------|------|------|
| id | BIGINT | 项目ID | 主键，自增 |
| project_name | VARCHAR(200) | 项目名称 | 非空 |
| category | VARCHAR(50) | 项目分类 | 教育助学/医疗救助/扶贫济困/环保公益 |
| description | TEXT | 项目描述 | |
| cover_image | VARCHAR(255) | 封面图片URL | |
| target_amount | DECIMAL(15,2) | 目标金额 | 非空，默认0.00 |
| current_amount | DECIMAL(15,2) | 当前已筹金额 | 默认0.00 |
| donor_count | INT | 捐赠人次 | 默认0 |
| view_count | INT | 浏览次数 | 默认0 |
| beneficiary | VARCHAR(200) | 受益人 | |
| location | VARCHAR(200) | 项目地点 | |
| start_date | DATETIME | 开始时间 | |
| end_date | DATETIME | 结束时间 | |
| status | TINYINT | 项目状态 | 0-待审核，1-进行中，2-已完成，3-已关闭，默认0 |
| thank_message | TEXT | 感谢留言 | |
| create_by | BIGINT | 创建人ID | |
| create_time | DATETIME | 创建时间 | 默认CURRENT_TIMESTAMP |
| update_time | DATETIME | 更新时间 | 默认CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP |
| deleted | TINYINT | 逻辑删除 | 0-未删除，1-已删除，默认0 |

**索引**：
- idx_category：分类索引（加速按分类筛选）
- idx_status：状态索引（加速按状态筛选）
- idx_create_by：创建人索引（加速查询创建人的项目）

### 4.3 捐赠记录表（donation_record）

| 字段名 | 类型 | 说明 | 约束 |
|--------|------|------|------|
| id | BIGINT | 记录ID | 主键，自增 |
| user_id | BIGINT | 捐赠用户ID | |
| project_id | BIGINT | 项目ID | 非空，外键关联donation_project.id |
| amount | DECIMAL(15,2) | 捐赠金额 | 非空 |
| payment_method | VARCHAR(50) | 支付方式 | alipay/wechat/bank，默认alipay |
| transaction_id | VARCHAR(100) | 交易流水号 | |
| donation_no | VARCHAR(100) | 捐赠编号 | 非空，唯一 |
| message | TEXT | 捐赠留言 | |
| is_anonymous | TINYINT | 是否匿名 | 0-否，1-是，默认0 |
| status | TINYINT | 捐赠状态 | 0-待支付，1-已支付，2-已取消，默认1 |
| donation_date | DATETIME | 捐赠时间 | |
| create_time | DATETIME | 创建时间 | 默认CURRENT_TIMESTAMP |
| update_time | DATETIME | 更新时间 | 默认CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP |
| deleted | TINYINT | 逻辑删除 | 0-未删除，1-已删除，默认0 |

**索引**：
- idx_user_id：用户ID索引（加速查询用户的捐赠记录）
- idx_project_id：项目ID索引（加速查询项目的捐赠记录）
- idx_status：状态索引（加速按状态筛选）
- idx_donation_date：捐赠日期索引（加速按日期查询）
- idx_donation_no：捐赠编号索引（加速按编号查询）

**外键**：
- project_id → donation_project(id)，级联删除

### 4.4 评论表（comment）

| 字段名 | 类型 | 说明 | 约束 |
|--------|------|------|------|
| id | BIGINT | 评论ID | 主键，自增 |
| project_id | BIGINT | 项目ID | 非空，外键关联donation_project.id |
| user_id | BIGINT | 用户ID | |
| content | TEXT | 评论内容 | 非空 |
| likes_count | INT | 点赞数 | 默认0 |
| status | TINYINT | 评论状态 | 0-隐藏，1-显示，2-已删除，默认1 |
| comment_date | DATETIME | 评论时间 | |
| create_time | DATETIME | 创建时间 | 默认CURRENT_TIMESTAMP |
| update_time | DATETIME | 更新时间 | 默认CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP |
| deleted | TINYINT | 逻辑删除 | 0-未删除，1-已删除，默认0 |

**索引**：
- idx_project_id：项目ID索引（加速查询项目的评论）
- idx_user_id：用户ID索引（加速查询用户的评论）
- idx_status：状态索引（加速按状态筛选）

**外键**：
- project_id → donation_project(id)，级联删除

### 4.5 通知表（notification）

| 字段名 | 类型 | 说明 | 约束 |
|--------|------|------|------|
| id | BIGINT | 通知ID | 主键，自增 |
| user_id | BIGINT | 接收用户ID | 为空表示系统通知 |
| title | VARCHAR(200) | 通知标题 | 非空 |
| content | TEXT | 通知内容 | |
| type | TINYINT | 通知类型 | 1-系统通知，2-捐赠通知，3-活动通知，默认1 |
| is_read | TINYINT | 是否已读 | 0-未读，1-已读，默认0 |
| send_date | DATETIME | 发送时间 | |
| create_time | DATETIME | 创建时间 | 默认CURRENT_TIMESTAMP |
| update_time | DATETIME | 更新时间 | 默认CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP |
| deleted | TINYINT | 逻辑删除 | 0-未删除，1-已删除，默认0 |

**索引**：
- idx_user_id：用户ID索引（加速查询用户的通知）
- idx_is_read：已读状态索引（加速统计未读数量）
- idx_send_date：发送日期索引（加速按日期排序）

### 4.6 数据统计表（statistics）

| 字段名 | 类型 | 说明 | 约束 |
|--------|------|------|------|
| id | BIGINT | 统计ID | 主键，自增 |
| stat_date | DATE | 统计日期 | 非空，唯一 |
| total_donation_amount | DECIMAL(15,2) | 当日捐赠总额 | 默认0.00 |
| total_donation_count | INT | 当日捐赠次数 | 默认0 |
| total_project_count | INT | 项目总数 | 默认0 |
| total_user_count | INT | 用户总数 | 默认0 |
| create_time | DATETIME | 创建时间 | 默认CURRENT_TIMESTAMP |
| update_time | DATETIME | 更新时间 | 默认CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP |

**索引**：
- idx_stat_date：统计日期索引（加速按日期查询）

### 4.7 用户偏好表（user_preference）

| 字段名 | 类型 | 说明 | 约束 |
|--------|------|------|------|
| id | BIGINT | 偏好ID | 主键，自增 |
| user_id | BIGINT | 用户ID | 非空 |
| category | VARCHAR(50) | 项目分类 | 非空 |
| score | DECIMAL(10,2) | 偏好得分 | 默认0.0 |
| view_count | INT | 浏览次数 | 默认0 |
| donation_count | INT | 捐赠次数 | 默认0 |
| create_time | DATETIME | 创建时间 | 默认CURRENT_TIMESTAMP |
| update_time | DATETIME | 更新时间 | 默认CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP |
| deleted | TINYINT | 逻辑删除 | 0-未删除，1-已删除，默认0 |

**索引**：
- uk_user_category：用户分类唯一索引（user_id + category）
- idx_user_id：用户ID索引（加速查询用户的偏好）

**唯一约束**：
- UNIQUE KEY uk_user_category (user_id, category)

### 4.8 系统配置表（system_config）

| 字段名 | 类型 | 说明 | 约束 |
|--------|------|------|------|
| id | BIGINT | 配置ID | 主键，自增 |
| config_key | VARCHAR(100) | 配置键 | 非空，唯一 |
| config_value | TEXT | 配置值 | |
| description | VARCHAR(255) | 配置描述 | |
| created_at | DATETIME | 创建时间 | 默认CURRENT_TIMESTAMP |
| updated_at | DATETIME | 更新时间 | 默认CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP |

**索引**：
- idx_config_key：配置键索引（加速按键查询）

---

## 5. 技术架构

### 5.1 后端技术栈
- **框架**：Spring Boot 3.2.5
- **ORM**：Spring Data JPA（Hibernate）
- **数据库**：MySQL 8.0
- **认证**：JWT（JSON Web Token）
- **构建工具**：Maven
- **JDK版本**：Java 21
- **文件上传**：MultipartFile，支持头像和项目封面图片上传
- **密码加密**：BCrypt
- **跨域配置**：CORS

### 5.2 前端技术栈
- **框架**：Vue 3（组合式API + Setup语法糖）
- **UI组件库**：Element Plus 2.4.4
- **路由**：Vue Router 4.x
- **状态管理**：Pinia 2.x
- **HTTP客户端**：Axios 1.6.x
- **构建工具**：Vite 5.x
- **Node版本**：18.18.0
- **图表库**：ECharts 5.x（数据统计可视化）
- **二维码**：QRCode.js（证书二维码生成）
- **图片下载**：html2canvas（证书下载）
- **CSS预处理器**：SCSS（样式美化）
- **图标库**：Element Plus Icons

### 5.3 系统架构
- **架构模式**：前后端分离
- **接口风格**：RESTful API
- **数据格式**：JSON
- **统一响应格式**：
  ```json
  {
    "code": 200,
    "message": "操作成功",
    "data": {}
  }
  ```

---

## 6. 创新点说明

本项目包含以下**13个创新点**，符合毕设要求：

### 6.1 AI智能推荐（核心创新点）
- **功能描述**：基于用户浏览和捐赠行为，智能推荐符合用户偏好的捐赠项目
- **创新价值**：
  - 提升用户捐赠体验，快速找到感兴趣的项目
  - 促进用户参与捐赠，提高捐赠转化率
  - 体现AI技术在公益领域的应用
  - 具有较高的技术含量和实用价值
  - 冷启动处理机制，新用户也能获得推荐
  - 多维度评分算法，推荐结果更准确

### 6.2 匿名捐赠功能
- **功能描述**：用户在捐赠时可以选择是否匿名
- **创新价值**：
  - 保护用户隐私，满足不同用户的捐赠需求
  - 提高用户参与捐赠的积极性
  - 符合现代公益捐赠的发展趋势

### 6.3 数据统计与可视化
- **功能描述**：管理员可以查看系统的各项统计数据，并以图表形式展示
- **创新价值**：
  - 实时展示系统运营数据
  - 多维度数据分析（按日期、按分类等）
  - 为管理决策提供数据支持
  - 提升系统的专业性和实用性
  - 每日趋势图直观展示捐赠变化
  - ECharts图表库，展示效果美观

### 6.4 捐赠证书生成与下载
- **功能描述**：用户可以为每笔捐赠生成电子捐赠证书并下载
- **创新价值**：
  - 提供正式的捐赠凭证，增加仪式感
  - 可保存和分享，扩大公益影响力
  - 提升用户捐赠荣誉感
  - 二维码验证功能提升证书可信度
  - html2canvas技术实现图片下载

### 6.5 感谢留言功能
- **功能描述**：管理员可以为项目发布感谢留言，向所有捐赠人表达感谢
- **创新价值**：
  - 增强捐赠反馈体验
  - 提升捐赠人参与感和荣誉感
  - 促进公益文化传播和社会正能量

### 6.6 头像上传与管理
- **功能描述**：用户可以上传和更换个人头像，提升用户体验
- **创新价值**：
  - 增强用户个性化体验
  - 提升系统美观度
  - 符合现代Web应用标准
  - MultipartFile文件上传技术

### 6.7 项目封面图片管理
- **功能描述**：管理员可以为每个项目上传和更换封面图片
- **创新价值**：
  - 提升项目展示效果
  - 增强视觉吸引力
  - 灵活管理项目展示内容

### 6.8 完整支付流程模拟
- **功能描述**：点击"立即捐赠"后展示支付方式选择、支付二维码、捐赠成功弹窗的完整流程
- **创新价值**：
  - 提升用户捐赠体验，模拟真实支付场景
  - 捐赠成功后动态展示项目名称，增强仪式感
  - 点击"查看详情"可直接跳转到捐赠记录页面
  - 无需真实支付接口，降低开发复杂度，适合毕设场景
  - 3秒倒计时自动完成，提升交互体验

### 6.9 累计捐赠金额实时计算
- **功能描述**：从捐赠记录表中实时计算用户的累计捐赠金额，确保数据准确性
- **创新价值**：
  - 解决历史数据累计捐赠不准确的问题
  - 每次获取用户信息时自动从数据库统计
  - 数据实时同步，可靠性高
  - 为用户提供准确的捐赠数据展示

### 6.10 登录页面美化
- **功能描述**：登录页面支持自定义背景图片、大学名称水印、半透明毛玻璃效果
- **创新价值**：
  - 提升系统视觉美观度
  - 符合高校毕设的设计风格
  - 增强用户第一印象
  - 水印展示大学名称，突出毕设特色

### 6.11 修改密码功能（新增）
- **功能描述**：用户可以修改登录密码，验证原密码后设置新密码
- **创新价值**：
  - 增强账户安全性
  - 符合信息安全最佳实践
  - 提供完整的用户账户管理功能
  - BCrypt密码加密验证

### 6.12 系统设置安全提醒（新增）
- **功能描述**：管理员页面显示安全提醒，提示管理员注意账户安全
- **创新价值**：
  - 增强系统安全性
  - 提高管理员安全意识
  - 防止安全事故发生
  - 体现系统的专业性和完整性

### 6.13 首页和项目列表UI美化（新增）
- **功能描述**：首页和项目列表页面采用现代化UI设计，包含丰富的交互动画
- **创新价值**：
  - 现代化UI设计，符合当前Web应用审美
  - 丰富的交互动画，提升用户体验
  - 渐变色彩搭配，视觉效果出色
  - 完全响应式，适配各种设备
  - 项目卡片高度一致，布局整齐美观

---

## 7. 非功能需求

### 7.1 性能需求
- 系统响应时间：页面加载时间不超过3秒
- 并发支持：支持至少100个用户同时在线
- 数据处理：捐赠记录查询响应时间不超过1秒
- 文件上传：图片上传响应时间不超过5秒
- 动画流畅度：交互动画帧率不低于60fps
- 数据库查询：单表查询响应时间不超过500ms

### 7.2 安全需求
- 用户密码BCrypt加密存储
- 登录采用JWT Token认证
- 敏感操作需要身份验证
- 防止SQL注入、XSS攻击
- 文件上传限制格式和大小
- 静态资源访问安全配置
- 密码修改功能验证原密码
- 管理员账户安全提醒
- Token有效期管理
- 跨域请求安全配置

### 7.3 可用性需求
- 界面简洁美观，操作流程清晰
- 提供友好的错误提示
- 支持主流浏览器（Chrome、Firefox、Edge）
- 图片加载失败时显示默认占位图
- 完全响应式设计，适配各种设备
- 交互动画流畅自然
- 操作反馈及时明确
- 加载状态提示

### 7.4 可维护性需求
- 代码结构清晰，注释完整
- 遵循编码规范（阿里巴巴Java开发手册、Vue风格指南）
- 前后端接口文档完整
- 使用DTO模式处理数据传输
- 组件化开发，易于维护和扩展
- Git版本管理
- 统一的异常处理机制
- 日志记录完整

---

## 8. 功能模块统计

### 8.1 功能清单
| 模块 | 子模块 | 功能数量 |
|------|--------|----------|
| 用户管理 | 注册、登录（含美化）、个人信息（含头像上传、累计捐赠实时计算）、修改密码、用户管理 | 5 |
| 捐赠项目 | 列表（含UI美化）、详情、捐赠（含完整支付流程）、封面图片管理、感谢留言 | 5 |
| 捐赠记录 | 我的记录、捐赠证书（含下载） | 2 |
| 评论互动 | 发表、列表、点赞、删除 | 4 |
| 通知管理 | 列表、未读计数、标记已读 | 3 |
| 管理员功能 | 项目管理、数据统计、系统设置（安全提醒） | 3 |
| 首页美化 | 首页UI设计 | 1 |
| AI智能推荐 | 个性化项目推荐、用户偏好分析 | 2 |
| **总计** | | **25个核心功能** |

---

## 9. 测试账号

系统预设以下测试账号：

| 账号 | 密码 | 角色 | 说明 |
|------|------|------|------|
| admin | 123456 | 管理员 | 拥有所有权限 |
| user1 | 123456 | 普通用户 | 测试用户张三 |
| user2 | 123456 | 普通用户 | 测试用户李四 |

---

## 10. 项目进度安排

| 阶段 | 工作内容 | 预计时间 |
|------|----------|----------|
| 第一阶段 | 需求分析与数据库设计 | 1周 |
| 第二阶段 | 后端接口开发（用户、项目、捐赠、评论、通知） | 2周 |
| 第三阶段 | 后端接口开发（AI推荐、统计、系统配置） | 1周 |
| 第四阶段 | 前端页面开发（登录、注册、首页、项目列表、详情） | 2周 |
| 第五阶段 | 前端页面开发（捐赠记录、个人中心、管理员后台） | 1周 |
| 第六阶段 | UI美化与交互动画（首页、列表、登录页） | 1周 |
| 第七阶段 | 系统联调与测试 | 1周 |
| 第八阶段 | 论文撰写与答辩准备 | 1周 |
| **总计** | | **10周** |

---

## 11. 总结

本公益捐赠管理系统实现了**8大功能模块、25个核心功能**，包括：
- 用户管理模块（注册、登录、个人信息、修改密码、用户管理）
- 捐赠项目模块（列表、详情、捐赠、封面图片管理、感谢留言）
- 捐赠记录模块（我的记录、捐赠证书）
- 评论互动模块（发表、列表、点赞、删除）
- 通知管理模块（列表、未读计数、标记已读）
- 管理员功能模块（项目管理、数据统计、系统设置）
- 首页美化模块（现代化UI设计）
- AI智能推荐模块（个性化项目推荐、用户偏好分析）

系统采用Spring Boot 3 + Vue 3的技术栈，符合本科毕设的功能复杂度要求。系统包含**13个创新点**：
1. AI智能推荐（核心创新点）
2. 匿名捐赠功能
3. 数据统计与可视化（含每日趋势图）
4. 捐赠证书生成与下载
5. 感谢留言功能
6. 头像上传与管理
7. 项目封面图片管理
8. 完整支付流程模拟
9. 累计捐赠金额实时计算
10. 登录页面美化
11. 修改密码功能
12. 系统设置安全提醒
13. 首页和项目列表UI美化

系统功能完整、界面美观、技术先进、交互流畅，具有较高的实用价值和应用前景，完全能够满足毕设答辩要求。
